# 贡献指南

<cite>
**本文档引用的文件**  
- [main.py](file://main.py)
- [requirements.txt](file://requirements.txt)
- [run.py](file://run.py)
- [pyqt_webview.py](file://pyqt_webview.py)
- [setup_cx.py](file://setup_cx.py)
- [structue_intro.txt](file://structue_intro.txt)
</cite>

## 目录
1. [简介](#简介)
2. [代码规范](#代码规范)
3. [提交流程](#提交流程)
4. [测试方法](#测试方法)
5. [项目依赖项](#项目依赖项)
6. [联系方式与讨论渠道](#联系方式与讨论渠道)

## 简介
Markdo 是一个基于 PyQt6 的现代 Markdown 编辑器，支持实时预览、语法高亮、悬浮工具栏、主题切换和多标签页编辑。本贡献指南旨在帮助社区开发者理解项目结构、遵循代码规范、正确提交修改，并确保代码质量和功能稳定性。

## 代码规范

### Python 代码风格
本项目严格遵循 PEP 8 代码风格指南。所有代码必须满足以下要求：
- 使用 4 个空格进行缩进，禁止使用 Tab
- 每行代码不超过 88 个字符（推荐使用 black 格式化工具）
- 导入语句按标准库、第三方库、本地模块分组，每组之间用空行分隔
- 变量和函数名使用小写字母和下划线（snake_case）
- 类名使用驼峰命名法（CamelCase）
- 常量使用大写字母和下划线（UPPER_CASE）

**Section sources**
- [main.py](file://main.py#L5-L20)

### 文档字符串要求
所有类、函数和方法必须包含清晰的文档字符串（docstring），遵循 Google 风格或 Sphinx 风格。文档字符串应包括：
- 功能描述
- 参数说明（类型和含义）
- 返回值说明（类型和含义）
- 异常说明（如适用）

例如，在 `MarkdownHighlighter` 类中，每个方法都有明确的文档字符串说明其功能。

**Section sources**
- [main.py](file://main.py#L523-L648)

### PyQt6 信号与槽命名约定
本项目采用清晰的信号与槽命名约定，确保事件处理逻辑的可读性和可维护性：
- 自定义信号使用 `pyqtSignal()` 定义，命名采用小写字母和下划线
- 槽函数命名应清晰表达其功能，通常以动词开头
- 使用 `lambda` 表达式连接简单操作，复杂逻辑应定义独立方法
- 信号连接应使用 `connect()` 方法，并在适当时候使用 `disconnect()` 避免内存泄漏

例如，悬浮工具栏快捷键的连接方式：
```python
self.toolbar_shortcut.activated.connect(lambda: self.show_floating_toolbar())
```

**Section sources**
- [main.py](file://main.py#L1995)
- [main.py](file://main.py#L2011)

## 提交流程

### Fork 仓库
1. 登录 GitHub 账户
2. 访问 Markdo 项目主页
3. 点击 "Fork" 按钮创建个人仓库副本

### 创建特性分支
在本地克隆您的 fork 仓库后，创建新的特性分支：
```bash
git clone https://github.com/your-username/markdo.git
cd markdo
git checkout -b feature/your-feature-name
```

### 提交 Pull Request
1. 在特性分支上完成代码修改和测试
2. 提交更改：
```bash
git add .
git commit -m "描述您的更改"
git push origin feature/your-feature-name
```
3. 在 GitHub 上访问您的 fork 仓库
4. 点击 "Compare & pull request"
5. 填写 PR 标题和详细描述，说明更改内容和目的
6. 提交 Pull Request 等待审核

## 测试方法

### 运行应用
要运行 Markdo 应用，请执行以下步骤：
1. 确保已安装所有依赖项（参见"项目依赖项"部分）
2. 运行主程序：
```bash
python run.py
```
或直接运行：
```bash
python main.py
```

### 验证修改
当您修改代码后，特别是 UI 组件和核心功能时，请按以下步骤验证：
1. 启动应用，检查界面是否正常显示
2. 测试相关功能，确保没有引入新的 bug
3. 验证快捷键和工具栏功能是否正常工作
4. 检查主题切换是否正确应用
5. 测试多标签页操作的稳定性

### 核心模块测试要求
当修改以下核心模块时，必须进行充分测试：
- **MarkdownHighlighter**: 确保所有 Markdown 语法高亮正确显示，包括标题、粗体、斜体、代码块等
- **MarkdownEditor**: 验证编辑器功能完整性，包括文本输入、格式化、列表自动续接等
- **FloatingMarkdownToolbar**: 测试所有工具栏按钮功能，确保插入格式正确
- **实时预览系统**: 验证 Markdown 到 HTML 的转换准确性和实时性

**Section sources**
- [main.py](file://main.py#L523-L648)
- [main.py](file://main.py#L650-L800)
- [pyqt_webview.py](file://pyqt_webview.py#L28-L242)

## 项目依赖项
为确保贡献者能搭建一致的开发环境，请安装以下依赖项：

```txt
PyQt6>=6.4.0
PyQt6-WebEngine>=6.4.0
markdown>=3.4.0
Pygments>=2.15.0
pymdown-extensions>=10.0
```

安装方法：
```bash
pip install -r requirements.txt
```

这些依赖项支持以下核心功能：
- **PyQt6**: GUI 界面框架
- **PyQt6-WebEngine**: HTML 预览引擎
- **markdown**: Markdown 解析
- **Pygments**: 代码高亮
- **pymdown-extensions**: 扩展 Markdown 功能

**Section sources**
- [requirements.txt](file://requirements.txt#L1-L5)

## 联系方式与讨论渠道
如果您在贡献过程中遇到问题或有改进建议，请通过以下方式联系我们：
- **GitHub Issues**: 提交 bug 报告或功能请求
- **Pull Requests**: 提交代码更改以供审核
- **项目文档**: 参考 `structue_intro.txt` 文件了解项目架构和设计思路

我们欢迎任何形式的贡献，包括但不限于：
- 修复 bug
- 改进性能
- 添加新功能
- 优化用户界面
- 完善文档
- 改进测试覆盖率

感谢您为 Markdo 项目做出贡献！

**Section sources**
- [structue_intro.txt](file://structue_intro.txt#L1-L93)